(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e6bd2830"],{1:function(e,t){},1846:function(e,t,l){"use strict";l("6011")},2:function(e,t){},"2b25":function(e,t,l){"use strict";l("8981")},3:function(e,t){},3462:function(e,t,l){},6011:function(e,t,l){},"7f16":function(e,t,l){"use strict";var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"PageTitle"},[e._v(e._s(e.title))])},n=[],r={props:["title"]},i=r,o=(l("2b25"),l("2877")),s=Object(o["a"])(i,a,n,!1,null,"3d9e3b04",null);t["a"]=s.exports},8981:function(e,t,l){},cb33:function(e,t,l){"use strict";l("3462")},f8ed:function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"schedule"},[l("PageTitle",{attrs:{title:e.company.name+" - 排班"}}),l("div",{staticClass:"btns"},[l("el-upload",{attrs:{action:"/","on-change":e.uploadChange,"show-file-list":!1,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","auto-upload":!1}},[l("el-button",{staticClass:"upload",attrs:{type:"primary",plain:"",icon:"el-icon-upload2"}},[e._v("排班导入")])],1),l("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-download"},on:{click:e.downExcle}},[e._v("排班导出")]),l("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-download"},on:{click:e.downTemplate}},[e._v("模版下载")])],1),l("div",{staticClass:"filter"},[l("span",[e._v("月份：")]),l("el-date-picker",{attrs:{type:"month",placeholder:"选择月份"},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}})],1),l("el-table",{staticStyle:{width:"400px","margin-bottom":"20px"},attrs:{data:e.scheduleList,border:""}},[l("el-table-column",{attrs:{align:"center",fixed:"",prop:"name",label:"排班名称"}}),l("el-table-column",{attrs:{align:"center",fixed:"",prop:"start",label:"开始时间"}}),l("el-table-column",{attrs:{align:"center",fixed:"",prop:"end",label:"结束时间"}})],1),l("el-table",{attrs:{data:e.list,border:""}},[l("el-table-column",{attrs:{align:"center",fixed:"",prop:"groupName",label:"设备组"}}),l("el-table-column",{attrs:{align:"center",fixed:"",prop:"id",label:"员工编号"}}),l("el-table-column",{attrs:{align:"center",fixed:"",prop:"name",label:"姓名"}}),l("el-table-column",{attrs:{align:"center",fixed:"",prop:"date",label:"月份",width:"100px"}}),l("el-table-column",{attrs:{align:"center",prop:"1",label:"1"}}),l("el-table-column",{attrs:{align:"center",prop:"2",label:"2"}}),l("el-table-column",{attrs:{align:"center",prop:"3",label:"3"}}),l("el-table-column",{attrs:{align:"center",prop:"4",label:"4"}}),l("el-table-column",{attrs:{align:"center",prop:"5",label:"5"}}),l("el-table-column",{attrs:{align:"center",prop:"6",label:"6"}}),l("el-table-column",{attrs:{align:"center",prop:"8",label:"8"}}),l("el-table-column",{attrs:{align:"center",prop:"9",label:"9"}}),l("el-table-column",{attrs:{align:"center",prop:"10",label:"10"}}),l("el-table-column",{attrs:{align:"center",prop:"11",label:"11"}}),l("el-table-column",{attrs:{align:"center",prop:"12",label:"12"}}),l("el-table-column",{attrs:{align:"center",prop:"13",label:"13"}}),l("el-table-column",{attrs:{align:"center",prop:"14",label:"14"}}),l("el-table-column",{attrs:{align:"center",prop:"15",label:"15"}}),l("el-table-column",{attrs:{align:"center",prop:"16",label:"16"}}),l("el-table-column",{attrs:{align:"center",prop:"17",label:"17"}}),l("el-table-column",{attrs:{align:"center",prop:"18",label:"18"}}),l("el-table-column",{attrs:{align:"center",prop:"19",label:"19"}}),l("el-table-column",{attrs:{align:"center",prop:"20",label:"20"}}),l("el-table-column",{attrs:{align:"center",prop:"21",label:"21"}}),l("el-table-column",{attrs:{align:"center",prop:"22",label:"22"}}),l("el-table-column",{attrs:{align:"center",prop:"23",label:"23"}}),l("el-table-column",{attrs:{align:"center",prop:"24",label:"24"}}),l("el-table-column",{attrs:{align:"center",prop:"25",label:"25"}}),l("el-table-column",{attrs:{align:"center",prop:"26",label:"26"}}),l("el-table-column",{attrs:{align:"center",prop:"27",label:"27"}}),l("el-table-column",{attrs:{align:"center",prop:"28",label:"28"}}),e.list[0]&&e.list[0]["29"]?l("el-table-column",{attrs:{align:"center",prop:"29",label:"29"}}):e._e(),e.list[0]&&e.list[0]["30"]?l("el-table-column",{attrs:{align:"center",prop:"30",label:"30"}}):e._e(),e.list[0]&&e.list[0]["31"]?l("el-table-column",{attrs:{align:"center",prop:"31",label:"31"}}):e._e()],1)],1)},n=[],r=(l("4160"),l("d81d"),l("45fc"),l("b0c0"),l("d3b7"),l("ac1f"),l("1276"),l("159b"),l("7f16")),i=l("1146"),o=l.n(i),s={components:{PageTitle:r["a"]},data:function(){return{month:"",company:{name:"吴江飞翔经编纺织有限公司"},scheduleTitle:{"排班名称":"name","开始时间":"start","结束时间":"end"},scheduleList:[],xlxsTitle:{"设备组":"groupName","员工编号":"id","姓名":"name","月份":"date",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12",13:"13",14:"14",15:"15",16:"16",17:"17",18:"18",19:"19",20:"20",21:"21",22:"22",23:"23",24:"24",25:"25",26:"26",27:"27",28:"28",29:"29",30:"30",31:"31"},list:[]}},mounted:function(){this.cid=this.getcid()},methods:{getcid:function(){return this.$route.query.cid&&"undefined"!=this.$route.query.cid?this.$route.query.cid:this.$store.state.user&&this.$store.state.user.userInfo&&this.$store.state.user.userInfo.Company.id},getTime:function(e){return e<10?"0"+e:e},formatDate:function(e,t){if(e<=1)return this.getTime(24*e)+":00";var l=new Date(24*(e-1)*36e5+1);l.setYear(l.getFullYear()-70);l.getFullYear(),l.getMonth(),l.getDate();var a=l.getHours()+"",n=l.getMinutes()+"";return t&&1===t.length?this.getTime(a)+t+this.getTime(n):this.getTime(a)+this.getTime(n)},uploadChange:function(e){var t=this,l=this,a=e.name.split(".")[1],n=["xlsx","xlc","xlm","xls","xlt","xlw","csv"].some((function(e){return e===a}));n||this.$message.error("文件格式错误，请重新选择文件！"),this.file2Xce(e).then((function(e){e&&e.length>0&&(e[0].sheet.map((function(e){var t={};for(var a in e)t[l.xlxsTitle[a]]=e[a];l.list.push(t)})),e[1].sheet.map((function(e){var a={};for(var n in e)"开始时间"!==n&&"结束时间"!==n||"number"!==typeof e[n]?a[l.scheduleTitle[n]]=e[n]:a[l.scheduleTitle[n]]=t.formatDate(e[n],":");l.scheduleList.push(a)})),console.log(l.list),console.log(l.scheduleList),l.list.length&&l.scheduleList.length?t.$message.success("上传成功"):t.$message.error("空文件或格式有误，请重新选择文件！"))}))},file2Xce:function(e){return new Promise((function(t,l){var a=new FileReader;a.onload=function(e){var l=this,a=e.target.result;this.wb=o.a.read(a,{type:"binary"});var n=[];this.wb.SheetNames.forEach((function(e){n.push({sheetName:e,sheet:o.a.utils.sheet_to_json(l.wb.Sheets[e])})})),t(n)},a.readAsBinaryString(e.raw)}))},downTemplate:function(){var e={header:["设备组","姓名","员工编号","月份","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"]},t={header:["排班名称","开始时间","结束时间"]},l=o.a.utils.json_to_sheet([],e),a=o.a.utils.json_to_sheet([],t),n=o.a.utils.book_new();o.a.utils.book_append_sheet(n,l,"排班"),o.a.utils.book_append_sheet(n,a,"排班配置"),o.a.writeFile(n,"挡车工排班表.xlsx")},downExcle:function(){var e=function(e,t){var l={header:["设备组","姓名","员工编号","月份","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"]},a={header:["排班名称","开始时间","结束时间"]},n=o.a.utils.json_to_sheet(e,l),r=o.a.utils.json_to_sheet(t,a),i=o.a.utils.book_new();o.a.utils.book_append_sheet(i,n,"排班"),o.a.utils.book_append_sheet(i,r,"排班配置"),o.a.writeFile(i,"挡车工排班表.xlsx")},t={name:"排班名称",start:"开始时间",end:"结束时间"},l={groupName:"设备组",id:"员工编号",name:"姓名",date:"月份",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12",13:"13",14:"14",15:"15",16:"16",17:"17",18:"18",19:"19",20:"20",21:"21",22:"22",23:"23",24:"24",25:"25",26:"26",27:"27",28:"28",29:"29",30:"30",31:"31"};e(this.filterJson(l,this.list),this.filterJson(t,this.scheduleList))},filterJson:function(e,t){var l=[];return t.map((function(t){var a={};for(var n in e)a[e[n]]=t[n];l.push(a)})),l}}},c=s,u=(l("cb33"),l("1846"),l("2877")),p=Object(u["a"])(c,a,n,!1,null,"a07a282e",null);t["default"]=p.exports}}]);